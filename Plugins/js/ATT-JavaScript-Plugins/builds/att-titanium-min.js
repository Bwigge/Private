/**
 * almond 0.2.5 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

var tiRequire=require;(function(){var e,t,n;(function(r){function d(e,t){return h.call(e,t)}function v(e,t){var n,r,i,s,o,u,a,f,c,h,p=t&&t.split("/"),d=l.map,v=d&&d["*"]||{};if(e&&e.charAt(0)===".")if(t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(f=0;f<e.length;f+=1){h=e[f];if(h===".")e.splice(f,1),f-=1;else if(h===".."){if(f===1&&(e[2]===".."||e[0]===".."))break;f>0&&(e.splice(f-1,2),f-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((p||v)&&d){n=e.split("/");for(f=n.length;f>0;f-=1){r=n.slice(0,f).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){s=i,o=f;break}}}if(s)break;!u&&v&&v[r]&&(u=v[r],a=f)}!s&&u&&(s=u,o=a),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function m(e,t){return function(){return s.apply(r,p.call(arguments,0).concat([e,t]))}}function g(e){return function(t){return v(t,e)}}function y(e){return function(t){a[e]=t}}function b(e){if(d(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!d(a,e)&&!d(c,e))throw new Error("No "+e);return a[e]}function w(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function E(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice;o=function(e,t){var n,r=w(e),i=r[0];return e=r[1],i&&(i=v(i,t),n=b(i)),i?n&&n.normalize?e=n.normalize(e,g(t)):e=v(e,t):(e=v(e,t),r=w(e),i=r[0],e=r[1],i&&(n=b(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return m(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:E(e)}}},i=function(e,t,n,i){var s,l,h,p,v,g=[],w;i=i||e;if(typeof n=="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(v=0;v<t.length;v+=1){p=o(t[v],i),l=p.f;if(l==="require")g[v]=u.require(e);else if(l==="exports")g[v]=u.exports(e),w=!0;else if(l==="module")s=g[v]=u.module(e);else if(d(a,l)||d(f,l)||d(c,l))g[v]=b(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,m(i,!0),y(l),{}),g[v]=a[l]}}h=n.apply(a[e],g);if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!w)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){return typeof e=="string"?u[e]?u[e](t):b(o(e,t).f):(e.splice||(l=e,t.splice?(e=t,t=n,n=null):e=r),t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s)},s.config=function(e){return l=e,l.deps&&s(l.deps,l.callback),s},n=function(e,t,n){t.splice||(n=t,t=[]),!d(a,e)&&!d(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}})(),n("../lib/almond",function(){}),n("att/util",["require","exports","module"],function(e,t,n){function r(e,t,n){if(typeof e=="object"&&e!==null){var r=n||e;if(e.forEach){if(e.every){var i;return this.every(function(){return i=t.apply(this,arguments),!i},r),i}e.forEach.call(e,t,n)}else for(var s in e)if(e.hasOwnProperty(s)){var i=t.call(r,e[s],s,e);if(i)return i}}}function i(e){var t=Array.prototype.slice.call(arguments,1).reverse();return t.forEach(function(t){r(t,function(t,n){e[n]=t})}),e}function s(e){return e===null||e===undefined||e===""}function o(e,t){var n={};try{r(e,function(e,r){if(!e)return;var i=u(t,e);s(i)||(n[r]=i)})}catch(i){return i}return n}function u(e,t){typeof t=="string"&&(t={backup:t});var n=t.paramKey,r=e[n]||"";if(!r&&t.backup){var i=typeof t.backup;i==="function"?r=t.backup(e,t):i==="string"&&(r=t.backup)}t.postProcess&&(r=t.postProcess(r,e,t)),t.prefix&&(r=t.prefix+r),t.suffix&&(r+=t.suffix);if(!r&&t.required){var s=n?' "'+n+'"':"";throw new Error("Required parameter"+s+" is undefined. Check the getHeaderConfig() for this method")}return t.validate&&t.validate(r,e,t),r}function f(e,t,n,r){e.push(encodeURIComponent(t)+r+encodeURIComponent(n))}function l(e,t,n){if(typeof e!="object")return"";var i=[],o=typeof n=="string"?n:l.defaultAssignment;return r(e,function(e,n){if(s(e))return;e instanceof Array?i.push(l.stringifyArray(n,e,t,o)):f(i,n,e,o)}),i.length===0?"":i.join(typeof t=="string"?t:l.defaultDelimiter)}function c(e,t,n){var r={},i=typeof n=="string"?n:l.defaultAssignment,s=e.split(typeof t=="string"?t:l.defaultDelimiter);return s.forEach(function(e){var t=e.split(i);if(t.length!==2)return;var n=decodeURIComponent(t[0]),s=decodeURIComponent(t[1]),o=r[n];o?o instanceof Array?o.push(s):r[n]=[o,s]:r[n]=s}),r}function h(e,t){return a.stringify(o(e,t))}function p(e,t){if(e==null)return e;var n=t.match(/(.*?)\.(.*)/);if(!n)return e[t];var r=n[1],i=n[2];return p(e[r],i)}t.forEach=r,t.copyObjTo=i,t.buildAllHeaders=o;var a=t.queryString=t.qs={};l.stringifyArray=function(e,t,n,r){var i=[],s=typeof r=="string"?r:l.defaultAssignment;return t.forEach(function(t,n){f(i,e,t,s)}),i.join(typeof n=="string"?n:l.defaultDelimiter)},l.defaultDelimiter="&",l.defaultAssignment="=",a.stringify=l,c.defaultDelimiter="&",c.defaultAssignment="=",a.parse=c,a.buildFromConfig=h,t.getFromObject=function(e,t){return p(e,t+"")}}),n("att/constants",["require","exports","module","att/util"],function(e,t,n){var r=e("att/util").copyObjTo;t.header={accept:{JSON:"application/json",XML:"application/xml",URL_ENCODED:"application/x-www-form-urlencoded"}},t.header.contentType=r({},t.header.accept)}),n("att/ajax",["require","exports","module","att/util","att/constants"],function(e,t,n){var r=e("att/util"),i=e("att/constants");function s(e,t){function f(e){if(!u){a&&clearTimeout(a),u=!0;var t=Array.prototype.slice.call(arguments,1);e.apply(n,t)}}function h(){a&&f(t.error,n,"abort")}typeof e!="string"&&(t=e,e=t.url),t=t||{};var n=typeof t.xhr=="function"?t.xhr():s.settings.xhr();if(!n)return;var o={},u=!1,a,l=function(e){var r;if(o.Accept&&o.Accept===i.header.accept.JSON)try{r=JSON.parse(n.responseText)}catch(s){f(t.error,n,"parsererror",s.message);return}else r=n.responseText;f(t.success,r,n.status,n)},c=function(e){f(t.error,n,"error",e.error||n.statusText)};n.onload=l,n.onerror=c,n.onabort=h;var p=typeof t.async=="undefined"?s.settings.async:t.async;n.open(t.type||(t.data?"POST":"GET"),e,p),r.copyObjTo(n,t.xhrFields),n.timeout=t.timeout||s.settings.timeout,r.copyObjTo(o,t.headers),r.forEach(o,function(e,t){e&&n.setRequestHeader(t,e)});var d=o["Content-Type"]===i.header.contentType.JSON&&typeof t.data=="object"?JSON.stringify(t.data):t.data;return n.send(d||undefined),n}return s.settings={xhr:function(){try{return new XMLHttpRequest}catch(e){console.log(e)}},async:!0,timeout:9e4},n.exports=s,s}),n("att/main",["require","exports","module","att/ajax","att/util","att/constants"],function(e,t,n){function l(e){s(this,e)}function c(e,t,n,r){var i=this.getRoot().bridgeFunction;if(!i)throw new Error("This function is not implemented for this platform");var s=this.getBridgeParams?this.getBridgeParams(e,t):{};i.call(this,s,n,r,e,t)}function h(e,t,n,i){function a(e){return function(){e&&e.apply(this,arguments),delete o.active}}typeof t=="function"&&i===undefined&&(i=n,n=t,t=e.getBackupParams?e.getBackupParams():{});var o={},u=e.getRoot(),f=function(u){var f=e.getAllHeaders(t);if(f instanceof Error){i(f.toString());return}u&&(f.Authorization="Bearer "+u);var l={url:e.getUrl(),type:e.type,headers:f,success:a(n),error:a(i)},c=e.executor?e.executor(l,t,n,i):l;if(c===l)try{o.active=r(l)}catch(h){i(h),o.error=h}else c&&c.constructor===Object?s(o,c):c instanceof Error?o.error=c:o.data=c};return e.skipAuthorization?f():u.accessToken?f(u.accessToken):o=u.generateAccessToken(a(f),a(i)),o}function v(e,t){var n=typeof e=="string"?e:a.stringify(e,",");return n}var r=e("att/ajax"),i=e("att/util"),s=i.copyObjTo,o=i.forEach,u=i.buildAllHeaders,a=i.qs,f=e("att/constants");s(l.prototype,{addObject:function(e,t){if(!(t instanceof l||typeof t=="function"))throw new Error("Only ATTObject or ATTMethod can be added with this method");var n=e.split("."),r=n.pop(),i=this;n.forEach(function(e){i[e]||(i[e]=new l),i=i[e]}),o(t.methods,function(e,n){t.addMethod(n,e.executor,e)}),delete t.methods,i[r]=t,t.parent=this},addMethod:function(e,t,n){function i(e,t,n){return i.parent.executor(i,e,t,n)}if(typeof t=="object"&&typeof n=="undefined"){var r=n;n=t,t=r}s(i,l.prototype,n),i.executor=t,i.methodName=e,this.addObject(e,i)},forEachToRoot:function(e,t){var n=this,r=0,i=t||this;do e.call(i,n,r++),n=n.parent;while(n)},getUrl:function(){var e="";return this.forEachToRoot(function(t){t.parent?e=(t.appendUrl||"")+e:e=(t.protocol+t.domain||"")+e}),e},getHeaderConfig:function(){var e;return this.forEachToRoot(function(t){e=s({},t.headerConfig,e)}),e},getRoot:function(){var e=this;while(e.parent)e=e.parent;return e},executor:function(){if(this.parent)return this.parent.executor.apply(this.parent,arguments)},getAllHeaders:function(e){return u(this.getHeaderConfig(),e)},buildQueryString:function(e){return"?"+a.buildFromConfig(this.qsConfig,e)}});var p=n.exports=new l({protocol:"https://",domain:"api.att.com",executor:h}),d={};return p.authorize=function(e,t,n,r,i){d.accessKeyId=e,d.secretKey=t,d.scope=n,d.grantType=r,d.outhCode=i},p.addMethod("generateAccessToken",function(t,n,r,i){var s={client_id:n.accessKeyId,client_secret:n.secretKey,grant_type:n.grantType};if(n.grantType==="authorization_code"&&n.outhCode!==null)s.code=n.outhCode;else if(n.grantType==="client_credentials")s.scope=n.scope;else{if(n.grantType!=="refresh_token"){var o=new Error("Invalid grantType. Call ATT.generateAccessToken to setup for authentication");return i(o),o}s.refresh_token=p.refreshToken}t.data=a.stringify(s);var u=t.success,l=t.error;return t.success=function(e,n,r){if(t.headers.Accept===f.header.accept.JSON&&typeof e=="String")try{e=JSON.parse(data)}catch(i){l.call(this,{error:i.message});return}p.isAuthCode===!0?(p.isAuthCode=!1,u.call(this,e.access_token)):s.grant_type==="client_credentials"||s.grant_type==="refresh_token"?(p.accessToken=e.access_token,p.refreshToken=e.refresh_token,u.call(this,p.accessToken)):l.call(this,{error:"Invalid grant type",data:data})},t.error=function(){var e=Array.prototype.slice.call(arguments,0);l.call(this,{error:o,args:e})},t},{appendUrl:"/oauth/access_token",type:"POST",getBackupParams:function(){return d},skipAuthorization:!0,headerConfig:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"}}),p.addObject("SMS",new l({appendUrl:"/sms/v3/messaging",headerConfig:{"Content-Type":{paramKey:"contentType"},Accept:{paramKey:"accept",required:!0,backup:"application/json"}},methods:{sendSMS:{appendUrl:"/outbox",type:"POST",executor:function(e,t){return e.data=t.contentType.toLowerCase()==="application/json"&&typeof t.body=="object"?JSON.stringify({outboundSMSRequest:t.body}):t.body,e}},getSMSDeliveryStatus:{appendUrl:"/outbox/",type:"GET",executor:function(e,t){return e.url+=t.smsId,e}},getSMS:{appendUrl:"/inbox/",type:"GET",executor:function(e,t){return e.url+=t.registrationId,e}}}})),p.addObject("MMS",new l({appendUrl:"/mms/v3/messaging/outbox",headerConfig:{Accept:{paramKey:"accept"}},methods:{sendMMS:{type:"POST",headerConfig:{"Content-Type":{paramKey:"contentType"}},executor:c,getBridgeParams:function(e,t){var n=e.headers["Content-Type"]===f.header.contentType.JSON?'{"outboundMessageRequest":'+(typeof t.body=="object"?JSON.stringify(t.body):t.body)+"}":t.body;return{body:n||"",contentType:e.headers["Content-Type"]||"",accept:e.headers.Accept||"",accessToken:e.headers.Authorization,url:e.url,attachments:t.attachments&&t.attachments.length>0?t.attachments:[{}]}}},getMMSDeliveryStatus:{type:"GET",executor:function(e,t,n,r){return e.url+="/"+t.id,e}}}})),function(){function t(e,t,n,r){var i=e.url;return i+=this.buildQueryString(t),n(i),i}function n(e,t){return e.url+t.notificationId,e}var e={Signature:{paramKey:"signature"},SignedPaymentDetail:{paramKey:"signedDocument"},clientid:{paramKey:"clientId"}};p.addObject("Payment",new l({appendUrl:"/rest/3/Commerce/Payment",methods:{newSubscription:{appendUrl:"/Subscriptions",type:"GET",skipAuthorization:!0,executor:t,qsConfig:e},getSubscriptionStatus:{appendUrl:"/Subscriptions/",type:"GET",headerConfig:{Accept:{paramKey:"accept"}},executor:function(e,t,n,r){return t.subscriptionId?e.url+="SubscriptionId/"+t.subscriptionId:t.merchantTransactionId?e.url+="MerchantTransactionId/"+t.merchantTransactionId:t.subscriptionAuthCode&&(e.url+="SubscriptionAuthCode/"+t.subscriptionAuthCode),e}},getSubscriptionDetails:{appendUrl:"/Subscriptions/",type:"GET",headerConfig:{Accept:{paramKey:"accept"}},executor:function(e,t,n,r){return e.url+=t.merchantSubscriptionId+"/Detail/"+t.consumerId,e}},newTransaction:{appendUrl:"/Transactions",type:"GET",skipAuthorization:!0,executor:t,qsConfig:e},getTransactionStatus:{appendUrl:"/Transaction/",type:"GET",headerConfig:{Accept:{paramKey:"accept"}},executor:function(e,t,n,r){return t.transactionId?e.url+="TransactionId/"+t.transactionID:t.merchantTransactionId?e.url+="MerchantTransactionId/"+t.merchantTransactionId:t.transactionAuthCode&&(e.url+="TransactionAuthCode/"+t.transactionAuthCode),e}},refundTransaction:{appendUrl:"/Transactions",type:"PUT",headerConfig:{"Content-Type":{paramKey:"contentType"},Accept:{paramKey:"accept"}},executor:function(e,t,n,r){return e.url+=t.transactionId+"?Action="+t.action,e.data=t.body,e}},getNotification:{appendUrl:"/Notifications/",type:"GET",headerConfig:{Accept:{paramKey:"accept"}},executor:n},acknowledgeNotification:{appendUrl:"/Notifications/",type:"PUT",headerConfig:{Accept:{paramKey:"accept"}},executor:n}}}))}(),p.addObject("IMMN",new l({appendUrl:"/rest/1/MyMessages",headerConfig:{Accept:{paramKey:"accept"}},methods:{sendMessage:{type:"POST",headerConfig:{"Content-Type":{paramKey:"contentType"}},executor:c,getBridgeParams:function(e,t){return{body:t.body||"",contentType:e.headers["Content-Type"]||"",accept:e.headers.Accept||"",accessToken:e.headers.Authorization,url:e.url,attachments:t.attachments&&t.attachments.length>0?t.attachments:[{}]}}},getMessageHeaders:{type:"GET",executor:function(e,t){return e.url+=this.buildQueryString(t),e},qsConfig:{HeaderCount:{paramKey:"headerCount"},IndexCursor:{paramKey:"indexCursor"}}},getMessageContent:{type:"GET",executor:function(e,t){return e.url+="/"+t.messageId,t.partNumber&&(e.url+="/"+t.partNumber),e}}}})),p.addObject("CMS",new l({appendUrl:"/rest/1/Sessions",headerConfig:{"Content-Type":{paramKey:"contentType"},Accept:{paramKey:"accept"}},methods:{createSession:{type:"POST",executor:function(e,t){return!t.body||!t.body.feature?new Error("params.body.feature is missing"):(e.data=t.body,e)}},sendSignal:{type:"POST",executor:function(e,t){return e.url+="/"+t.cmsId+"/Signals",e.data=t.body,e}}}})),p.addObject("OAuth",new l({appendUrl:"/oauth",methods:{obtainEndUserAuthorization:{type:"GET",appendUrl:"/authorize",skipAuthorization:!0,executor:function(e,t){return t.clientId!==undefined&&t.scope!==undefined&&(e.url+=this.buildQueryString(t)),e},qsConfig:{client_id:{paramKey:"clientId"},scope:{paramKey:"scope"},redirect_url:{paramKey:"redirectUrl"}}}}})),p.addObject("WAPPush",new l({appendUrl:"/1/messages/outbox/wapPush",methods:{sendWAPPush:{type:"POST",headerConfig:{"Content-Type":{paramKey:"contentType"},Accept:{paramKey:"accept"}},executor:c,getBridgeParams:function(e,t){return{url:e.url,accessToken:e.headers.Authorization,contentType:e.headers["Content-Type"]||"",accept:e.headers.Accept||"",body:t.body?t.body:"null",data:t.data?t.data:"null"}}}}})),p.addObject("Location",new l({appendUrl:"/2/devices/location",methods:{getDeviceLocation:{type:"GET",headerConfig:{Accept:{paramKey:"accept"}},executor:function(e,t){return e.url+=this.buildQueryString(t),e},qsConfig:{requestedAccuracy:{paramKey:"requestedAccuracy"},tolerance:{paramKey:"tolerance"},acceptableAccuracy:{paramKey:"acceptableAccuracy"}}}}})),p.addObject("Speech",new l({appendUrl:"/speech/v3/speechToText",methods:{speechToText:{type:"POST",headerConfig:{Accept:{paramKey:"accept"},"Content-Type":{paramKey:"contentType",required:!0},"Transfer-Encoding":{paramKey:"transferEncoding"},"X-SpeechContext":{paramKey:"xSpeechContext"},"X-SpeechSubContext":{paramKey:"xSpeechSubContext"},"Content-Language":{paramKey:"contentLanguage"},"Content-Length":{paramKey:"contentLength",backup:function(e){try{var t=Ti.Filesystem.getFile(e.filePath);return t.length}catch(n){}}},"X-Arg":{paramKey:"xArg",postProcess:v}},executor:c,getBridgeParams:function(e,t){return{filePath:t.filePath||"",host:e.url,token:e.headers.Authorization,headerAccept:e.headers.Accept||"",headerContentType:e.headers["Content-Type"]||"",headerXSpeechContent:e.headers["X-SpeechContext"]||"",headerContentLength:e.headers["Content-Length"]||"",headerTransferEncoding:e.headers["Transfer-Encoding"]||"",headerContentLanguage:e.headers["Content-Language"]||"",headerXSpeechSubContext:e.headers["X-SpeechSubContext"]||"",headerXArg:e.headers["X-Arg"]||""}}}}})),p}),t(["att/main","att/util","att/ajax","att/constants"],function(e,t,n,r){n.settings.xhr=function(){try{return Ti.Network.createHTTPClient()}catch(e){}},e.bridgeFunction=function(t,n,i){var s=tiRequire("ti.api.att"),o;t.accept&&n?o=function(e){n.call(this,t.accept===r.header.accept.XML?e.success:e)}:o=n,s[this.methodName](t,o,i)},e.WAPPush.sendWAPPush.methodName="sendWapPush";var i=e.Speech.speechToText.executor;e.Speech.speechToText.executor=function(e,t,n,r){if(Ti.Platform.osname==="android")return i.apply(this,arguments);try{var s=Ti.Filesystem.getFile(t.filePath);e.data=s.read()}catch(o){return o}return e};var u=e.executor;return e.executor=function(e,t,n,r){var i=n;i&&(arguments[2]=function(e,t,n){if(typeof e=="object"&&e!==null)try{arguments[0]=JSON.stringify(e)}catch(r){}i.apply(this,arguments)});var s=r;return s&&(arguments[3]=function(e,t,n){r.call(e,{error:{type:t,description:n,xhr:e}})}),u.apply(this,arguments)},e}),n("att-titanium",function(){}),typeof exports!="undefined"&&(exports.ATT=e("att/main"))})();